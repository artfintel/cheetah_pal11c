<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="Generator" content="iWeb 3.0.4" />
    <meta name="iWeb-Build" content="local-build-20170406" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <meta name="viewport" content="width=700" />
    <title>CrystFEL from the GUI</title>
    <link rel="stylesheet" type="text/css" media="screen,print" href="Indexing_files/Indexing.css" />
    <!--[if lt IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='Indexing_files/IndexingIE.css'/><![endif]-->
    <!--[if gte IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='Media/IE8.css'/><![endif]-->
    <script type="text/javascript" src="Scripts/iWebSite.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/SharedResources/WidgetCommon.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/Navbar/navbar.js"></script>
    <script type="text/javascript" src="Scripts/iWebImage.js"></script>
    <script type="text/javascript" src="Indexing_files/Indexing.js"></script>
  </head>
  <body style="background: rgb(101, 101, 101); margin: 0pt; " onload="onPageLoad();" onunload="onPageUnload();">
    <div style="text-align: center; ">
      <div style="margin-bottom: 10px; margin-left: auto; margin-right: auto; margin-top: 10px; overflow: hidden; position: relative; word-wrap: break-word;  background: rgb(255, 255, 255); text-align: left; width: 700px; " id="body_content">
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 0; " id="nav_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div style="height: 1px; line-height: 1px; " class="tinyText"> </div>
          <div class="com-apple-iweb-widget-navbar flowDefining" id="widget0" style="margin-left: 20px; margin-top: 24px; opacity: 1.00; position: relative; width: 660px; z-index: 1; ">
    
            <div id="widget0-navbar" class="navbar">

      
              <div id="widget0-bg" class="navbar-bg">

        
                <ul id="widget0-navbar-list" class="navbar-list">
 <li></li> 
</ul>
                
      
</div>
              
    
</div>
          </div>
          <script type="text/javascript"><!--//--><![CDATA[//><!--
new NavBar('widget0', 'Scripts/Widgets/Navbar', 'Scripts/Widgets/SharedResources', '.', {"path-to-root": "", "navbar-css": ".navbar {\n\tfont-family: 'Helvetica Neue', Arial, sans-serif;\n\tfont-size: .8em;\n\tcolor: #666666;\n\tline-height: 30px;\n\tborder-bottom: 3px solid #ccc;\n}\n\n.navbar-bg {\n\ttext-align: right;}\n\n.navbar-bg ul {\n\tlist-style: none;\n\tmargin: 0px;\n\tpadding: 0px;\n}\n\n\nli {\n\tlist-style-type: none;\n\tdisplay: inline;\n\tpadding: 0px 5px 0px 0px;\n}\n\n\nli a {\n\ttext-decoration: none;\n\tpadding: 10px;\n\tcolor: #666666;\n\tfont-weight: bold;\n}\n\nli a:visited {\n\ttext-decoration: none;\n\tpadding: 10px;\n\tcolor: #666666;\n\tfont-weight: bold;\n}\n\nli a:hover\r{\r\n \tcolor: #999999;\n\ttext-decoration: none;\r}\n\n\nli.current-page a\r{\r\t color: #66ABC5;\n\ttext-decoration: none;\r}\n", "current-page-GUID": "E3404E01-F16B-403A-9DB9-A2A26CEAA108", "isCollectionPage": "NO"});
//--><!]]></script>
          <div style="clear: both; height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="height: 198px; margin-left: 0px; position: relative; width: 700px; z-index: 10; " id="header_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id1" style="height: 55px; left: 20px; position: absolute; top: 20px; width: 585px; z-index: 1; " class="style_SkipStroke shape-with-text">
            <div class="text-content Normal_External_585_55" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="Header">CrystFEL from the GUI</p>
              </div>
            </div>
          </div>
          


          <div id="id2" style="height: 120px; left: 27px; position: absolute; top: 78px; width: 357px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_357_120" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">Index SFX data by run using the Cheetah GUI to launch <a title="http://www.desy.de/~twhite/crystfel/faq.html" href="http://www.desy.de/~twhite/crystfel/faq.html">CrystFEL</a> and view the output.<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Menu items call wrapper scripts around standard <a title="http://www.desy.de/~twhite/crystfel/faq.html" href="http://www.desy.de/~twhite/crystfel/faq.html">CrystFEL</a> operations. Fully customisable. <br /></p>
                <p class="Free_Form"><br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">Template indexing scripts are included in the Cheetah template: /reg/g/cfel/cheetah/template.tar</p>
              </div>
            </div>
          </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 5; " id="body_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div style="height: 454px; width: 518px;  height: 454px; left: 65px; position: absolute; top: 645px; width: 518px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="Indexing_files/droppedImage.png" alt="" style="border: none; height: 454px; width: 519px; " />
          </div>
          


          <div id="id3" style="height: 20px; left: 20px; position: absolute; top: 2176px; width: 515px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
            <div class="text-content Normal_External_515_20" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Where do I find the indexing output?</p>
              </div>
            </div>
          </div>
          


          <div id="id4" style="height: 20px; left: 20px; position: absolute; top: 58px; width: 515px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
            <div class="text-content Normal_External_515_20" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">How it works</p>
              </div>
            </div>
          </div>
          


          <div id="id5" style="height: 401px; left: 27px; position: absolute; top: 75px; width: 662px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_662_401" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">Basically automated housekeeping to simplify what you do using CrystFEL manually from the command line:<br /></p>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>A working directory is created in the cheetah/indexing directory for each run<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>A list of all events in the selected run is automatically created in this directory.  A copy of geometry, processing script, etc is also made in this directory for later reference. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>You are asked which indexing script to run.  This is simply a CrystFEL wrapper script that looks very much like the indexing scripts most people already use.  Do copy and modify them to suit your needs. All files matching the pattern index*.sh in the cheetah/process/ directory are listed in the drop-down menu so follow this file naming pattern. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>A geometry file is always asked for.  <span class="style">Geometry is critically important to indexing results</span> so we make you think about this step by deliberately asking you to select a geometry file rather than using a default value.  Default location for geometry files is in the cheetah/calib/geometry folder. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>The selected indexing script is sent to the batch queue for processing on your cluster using a batch queue wrapper script (yes, yet another wrapper wrapping a wrapper - this is to enable you to change the scripts as needed without having to change the python code itself, for example to use the GUI for indexing at home as described below)<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>Stream files are saved into the cheetah/indexing/streams directory and CrystFEL temporary output into the rXXXX directories. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>cheetah-crawler keeps an eye on the indexing directories and updates the tables with progress.<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>CrystFEL output is viewed using menu items to simplify the viewing of results. These point viewing programs to files in the standard locations and launch command-line processes. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="padding-bottom: 0pt; text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>Everything is in a standard location, much like the cheetah output itself, making it easier to find your results later</p>
                  </li>
                </ol>
              </div>
            </div>
          </div>
          


          <div id="id6" style="height: 20px; left: 20px; position: absolute; top: 1960px; width: 515px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
            <div class="text-content Normal_External_515_20" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Look at your data!</p>
              </div>
            </div>
          </div>
          


          <div id="id7" style="height: 151px; left: 27px; position: absolute; top: 1980px; width: 662px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_662_151" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style_2">Seriously. There is no substitute for looking at the peak finding and indexing results.  Check for unreliable regions on the detector, such as shadows.  Engage your brain.  Garbage in, garbage out.  <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form"><span class="style">Hint: </span>Indexing is deliberately performed on a per-run basis.  This splits the processing (parallelisation) while keeping data from the same run together.  It is not uncommon for certain runs to be best excluded from the dataset, for example due to a moved detector, different shadowing on the detector, jet misbehaviour or changes in unit cell parameters over time.  In some cases different batches of sample needed to be separated, in other cases certain runs are best excluded for other experimental reasons.  <br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">A run is a logical unit of division - not too large but also not too small.  We group data by run since a new run is typically started whenever a change is made to the system, so this is a logical breaking point in analysis. </p>
              </div>
            </div>
          </div>
          


          <div id="id8" style="height: 372px; left: 27px; position: absolute; top: 2198px; width: 662px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_662_372" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">Automation relies on enforcing some standard structure in the location of data.  Standardisation also helps you find your own data once you start processing many experiments at the same time, because it’s always in a familiar place.  <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Output is saved in the cheetah/indexing directory<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">A typical directory tree looks like:<br /></p>
                <p class="Free_Form">    &gt; ls indexing/<br /></p>
                <p class="Free_Form">        r0001-daq  <br /></p>
                <p class="Free_Form">        r0011-rice/  <br /></p>
                <p class="Free_Form">        streams<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    &gt; ls indexing/r0011-rice/<br /></p>
                <p class="Free_Form">        1vds.pdb  <br /></p>
                <p class="Free_Form">        cxin5016_v1.geom  <br /></p>
                <p class="Free_Form">        indexamajig.411  <br /></p>
                <p class="Free_Form">        r0011-rice-nocell.stream -&gt; ../streams/r0011-rice-nocell.stream     (symbolic link to stream file)<br /></p>
                <p class="Free_Form">        bsub.log  <br /></p>
                <p class="Free_Form">        files.lst         <br /></p>
                <p class="Free_Form">        index_nocell.sh<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    &gt; ls indexing/streams/<br /></p>
                <p class="Free_Form">        r0011-rice-nocell.stream<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">- Stream files are saved into the cheetah/indexing/streams directory<br /></p>
                <p class="Free_Form">- rXXXX is a working directory is created in the cheetah/indexing directory (for geometry, copy of processing script, etc)<br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="padding-bottom: 0pt; text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>Default location for geometry files is in the cheetah/calib/geometry folder.</p>
                  </li>
                </ol>
              </div>
            </div>
          </div>
          


          <div id="id9" style="height: 20px; left: 20px; position: absolute; top: 1125px; width: 515px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
            <div class="text-content Normal_External_515_20" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">How to</p>
              </div>
            </div>
          </div>
          


          <div id="id10" style="height: 372px; left: 32px; position: absolute; top: 1147px; width: 654px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_654_372" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="1">
                    <p style="padding-top: 0pt; text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">1)</span><span style="width: 3px; " class="inline-block"></span>Take a look at the template scripts in cheetah/process (check the latest version of /reg/g/cfel/cheetah/template.tar)<br /></p>
                  </li>
                </ol>
                <p class="Free_Form">    Indexing scripts: index*.sh<br />    Batch queue wrapper: queue.sh <br /></p>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="2">
                    <p style="text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">2)</span><span style="width: 3px; " class="inline-block"></span>Wait until Cheetah has finished hit finding the run of interest (or accept incomplete processing)<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="3">
                    <p style="text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">3)</span><span style="width: 3px; " class="inline-block"></span>Run CrystFEL-&gt;index mosflm-raw-nolatt-nocell<br />View output using CrystFEL-&gt; Cell explorer<br />This will generate the usual histograms.  Check that unit cell is what you expect. A bad unit cell or poor indexing rate is very informative and often indicates problems.<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="4">
                    <p style="text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">4)</span><span style="width: 3px; " class="inline-block"></span>If all looks OK, create a copy of one of the templates and add/change to make your own custom CrystFEL recipe (see below)<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="5">
                    <p style="text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">5)</span><span style="width: 3px; " class="inline-block"></span>Relaunch indexing using your modified script with unit cell information and wait for it to run<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="6">
                    <p style="text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">6)</span><span style="width: 3px; " class="inline-block"></span>Check overlay of indexing result with the found peaks and the real image data <br />CrystFEL-&gt;View indexing<br /><br /></p>
                  </li>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="7">
                    <p style="text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">7)</span><span style="width: 3px; " class="inline-block"></span><a title="cxiview.html" href="cxiview.html">cxiview</a> can be launched from the command line:<br />&gt; cxiview -s ../indexing/r0015-rice/r0035.stream<br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="8">
                    <p style="padding-bottom: 0pt; text-indent: -13px; " class="paragraph_style_3"><span style="font-size: 12px; " class="Bullet">8)</span><span style="width: 3px; " class="inline-block"></span>Merge stream files from different runs using<br />CrystFEL-&gt;merge stream files<br /></p>
                  </li>
                </ol>
              </div>
            </div>
          </div>
          


          <div id="id11" style="height: 20px; left: 20px; position: absolute; top: 2613px; width: 515px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
            <div class="text-content Normal_External_515_20" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">use for indExing at home</p>
              </div>
            </div>
          </div>
          


          <div id="id12" style="height: 652px; left: 27px; position: absolute; top: 2636px; width: 662px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_662_652" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">Indexing only relies on the presence of Cheetah output and availability of CrystFEL.  It does not depend on psana or availability of the raw facility data.  It is possible to copy the Cheetah output home and use the GUI to organise indexing of data locally, at home, on your own cluster.<br /></p>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>Leave the Cheetah directory structure intact, copy the whole cheetah/ tree (not just the HDF5 output).  <br /></p>
                  </li>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>Run cheetah-gui and check that you can view data... a sanity check<br /></p>
                  </li>
                  <li style="line-height: 14px; padding-left: 8px; text-indent: -8px; " class="full-width">
                    <p style="text-indent: -8px; " class="paragraph_style_1"><span style="font-size: 12px; " class="Bullet">-</span><span style="width: 3px; " class="inline-block"></span>Modify the batch submission script in queue_*.sh to suit your cluster. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Some mucking around with scripts may be necessary but you should only have to do it once and then share it with all your colleagues.  Check terminal output for errors.  Scripts work from the command line for debugging. <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Example batch queue wrapper: <br /></p>
                <p class="Free_Form">    &gt; cat /reg/g/cfel/cheetah/template/cheetah/process/queue_slac.sh<br /></p>
                <p class="Free_Form">    #!/bin/bash<br /></p>
                <p class="Free_Form">    #<br /></p>
                <p class="Free_Form">    # Parameters:<br /></p>
                <p class="Free_Form">    # $1 = Job tag<br /></p>
                <p class="Free_Form">    # $2 = Working directory for execution<br /></p>
                <p class="Free_Form">    # rest = command to execute<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    # Submit job to SLAC batch queue (psanaq, etc)<br /></p>
                <p class="Free_Form">    QUEUE='psanaq'<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    # Parameters passed from Cheetah GUI (use shift to extract final command) <br /></p>
                <p class="Free_Form">    LABEL=$1<br /></p>
                <p class="Free_Form">    WORKINGDIR=$2<br /></p>
                <p class="Free_Form">    shift<br /></p>
                <p class="Free_Form">    shift<br /></p>
                <p class="Free_Form">    COMMAND=$@<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    # For debugging<br /></p>
                <p class="Free_Form">    #echo &quot;Queue: &quot; $QUEUE<br /></p>
                <p class="Free_Form">    #echo &quot;Workingdir: &quot; $WORKINGDIR<br /></p>
                <p class="Free_Form">    #echo &quot;Label: &quot; $LABEL<br /></p>
                <p class="Free_Form">    #echo &quot;Command: &quot; $COMMAND<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    # Dependencies that may not be imported by default<br /></p>
                <p class="Free_Form">    source /reg/g/cfel/crystfel/crystfel-dev/setup-sh<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">    # Batch queue commands<br /></p>
                <p class="Free_Form">    FULLCOMMAND=&quot;bsub -q $QUEUE -o bsub.log -x -J $LABEL -cwd $WORKINGDIR $COMMAND&quot;<br /></p>
                <p class="Free_Form">    echo $FULLCOMMAND<br /></p>
                <p class="Free_Form">    $FULLCOMMAND<br /></p>
                <p class="Free_Form"><br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">Copy this file or your modified version to queue.sh to make it the default script. </p>
              </div>
            </div>
          </div>
          


          <div style="height: 146px; width: 346px;  height: 146px; left: 323px; position: absolute; top: 552px; width: 346px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="Indexing_files/droppedImage_1.png" alt="" style="border: none; height: 146px; width: 347px; " />
          </div>
          


          <div style="height: 136px; width: 350px;  height: 136px; left: 15px; position: absolute; top: 501px; width: 350px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="Indexing_files/droppedImage_2.png" alt="" style="border: none; height: 136px; width: 351px; " />
          </div>
          


          <div id="id13" style="height: 20px; left: 26px; position: absolute; top: 1513px; width: 515px; z-index: 1; " class="style_SkipStroke_3 shape-with-text">
            <div class="text-content Normal_External_515_20" style="padding: 0px; ">
              <div class="Normal">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style">Customise it</p>
              </div>
            </div>
          </div>
          


          <div id="id14" style="height: 400px; left: 38px; position: absolute; top: 1535px; width: 654px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_654_400" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">Indexing scripts will look familiar to anyone who runs CrystFEL from the command line.  <br /></p>
                <p class="Free_Form">    Tag, PDB file and Geometry file are passed from the GUI<br /></p>
                <p class="Free_Form">    All other options are controlled by this script.<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Copy and modify.  Files in cheetah/process matching index_*.sh are included in the drop down menu.  <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">&gt; less index_pdb.sh <br /></p>
                <p class="Free_Form">#. /reg/g/cfel/crystfel/crystfel-dev/setup-sh<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">TAG=$1<br /></p>
                <p class="Free_Form">PDB=$2<br /></p>
                <p class="Free_Form">GEOMFILE=$3<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">echo &quot;Indexing with known unit cell&quot;<br /></p>
                <p class="Free_Form">echo &quot;Using: &quot; $PDB<br /></p>
                <p class="Free_Form">echo &quot;Using: &quot; $GEOMFILE<br /></p>
                <p class="Free_Form">echo &quot;&gt;------------------------------------&lt;&quot;<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">ln -fs ../streams/$TAG.stream ./$TAG.stream<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">indexamajig -i files.lst -g $GEOMFILE \<br /></p>
                <p class="Free_Form">        -o ../streams/$TAG.stream \<br /></p>
                <p class="Free_Form">        --indexing=mosflm,xds,dirax,asdf \<br /></p>
                <p class="Free_Form">        --pdb=$PDB \<br /></p>
                <p class="Free_Form">        --int-radius=3,4,5 \<br /></p>
                <p class="Free_Form">        --peaks=cxi --check-hdf5-snr --min-snr=5 \<br /></p>
                <p class="Free_Form">        -j 24 <br /></p>
              </div>
            </div>
          </div>
          


          <div style="height: 216px; width: 224px;  height: 216px; left: 398px; position: absolute; top: -160px; width: 224px; z-index: 1; " class="tinyText style_SkipStroke_4 stroke_0">
            <img src="Indexing_files/droppedImage.jpg" alt="" style="border: none; height: 217px; width: 224px; " />
          </div>
          <div style="height: 3288px; line-height: 3288px; " class="spacer"> </div>
        </div>
        <div style="height: 75px; margin-left: 0px; position: relative; width: 700px; z-index: 15; " id="footer_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
        </div>
      </div>
    </div>
  </body>
</html>


