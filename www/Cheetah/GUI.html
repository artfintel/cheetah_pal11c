<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="Generator" content="iWeb 3.0.4" />
    <meta name="iWeb-Build" content="local-build-20170406" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <meta name="viewport" content="width=700" />
    <title>GUI</title>
    <link rel="stylesheet" type="text/css" media="screen,print" href="GUI_files/GUI.css" />
    <!--[if lt IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='GUI_files/GUIIE.css'/><![endif]-->
    <!--[if gte IE 8]><link rel='stylesheet' type='text/css' media='screen,print' href='Media/IE8.css'/><![endif]-->
    <script type="text/javascript" src="Scripts/iWebSite.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/SharedResources/WidgetCommon.js"></script>
    <script type="text/javascript" src="Scripts/Widgets/Navbar/navbar.js"></script>
    <script type="text/javascript" src="GUI_files/GUI.js"></script>
  </head>
  <body style="background: rgb(101, 101, 101); margin: 0pt; " onload="onPageLoad();" onunload="onPageUnload();">
    <div style="text-align: center; ">
      <div style="margin-bottom: 10px; margin-left: auto; margin-right: auto; margin-top: 10px; overflow: hidden; position: relative; word-wrap: break-word;  background: rgb(255, 255, 255); text-align: left; width: 700px; " id="body_content">
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 0; " id="nav_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div style="height: 1px; line-height: 1px; " class="tinyText"> </div>
          <div class="com-apple-iweb-widget-navbar flowDefining" id="widget0" style="margin-left: 20px; margin-top: 24px; opacity: 1.00; position: relative; width: 660px; z-index: 1; ">
    
            <div id="widget0-navbar" class="navbar">

      
              <div id="widget0-bg" class="navbar-bg">

        
                <ul id="widget0-navbar-list" class="navbar-list">
 <li></li> 
</ul>
                
      
</div>
              
    
</div>
          </div>
          <script type="text/javascript"><!--//--><![CDATA[//><!--
new NavBar('widget0', 'Scripts/Widgets/Navbar', 'Scripts/Widgets/SharedResources', '.', {"path-to-root": "", "navbar-css": ".navbar {\n\tfont-family: 'Helvetica Neue', Arial, sans-serif;\n\tfont-size: .8em;\n\tcolor: #666666;\n\tline-height: 30px;\n\tborder-bottom: 3px solid #ccc;\n}\n\n.navbar-bg {\n\ttext-align: right;}\n\n.navbar-bg ul {\n\tlist-style: none;\n\tmargin: 0px;\n\tpadding: 0px;\n}\n\n\nli {\n\tlist-style-type: none;\n\tdisplay: inline;\n\tpadding: 0px 5px 0px 0px;\n}\n\n\nli a {\n\ttext-decoration: none;\n\tpadding: 10px;\n\tcolor: #666666;\n\tfont-weight: bold;\n}\n\nli a:visited {\n\ttext-decoration: none;\n\tpadding: 10px;\n\tcolor: #666666;\n\tfont-weight: bold;\n}\n\nli a:hover\r{\r\n \tcolor: #999999;\n\ttext-decoration: none;\r}\n\n\nli.current-page a\r{\r\t color: #66ABC5;\n\ttext-decoration: none;\r}", "current-page-GUID": "9A6C2280-2624-40D3-A7EE-9FE125FF1D01", "isCollectionPage": "NO"});
//--><!]]></script>
          <div style="clear: both; height: 0px; line-height: 0px; " class="spacer"> </div>
        </div>
        <div style="height: 854px; margin-left: 0px; position: relative; width: 700px; z-index: 10; " id="header_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id2" style="height: 43px; left: 25px; position: absolute; top: 16px; width: 515px; z-index: 1; " class="style_SkipStroke shape-with-text">
            <div class="text-content style_External_515_43" style="padding: 0px; ">
              <div class="style">
                <div class="paragraph Header" style="padding-bottom: 0pt; padding-top: 0pt; "><div id="id1" style="height: 43px; position: relative; width: 515px; " class="style_SkipStroke shape-with-text inline-block"><div class="text-content style_External_515_43" style="padding: 0px; "><div class="style"><p style="padding-bottom: 0pt; padding-top: 0pt; " class="Header">Cheetah GUI interface</p></div></div></div></div>
              </div>
              <div style="clear: both; height: 0px; line-height: 0px; " class="tinyText"> </div>
            </div>
          </div>
          


          <div id="id3" style="height: 288px; left: 19px; position: absolute; top: 566px; width: 662px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_662_288" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">To <a title="Quick_start.html" href="Quick_start.html">start the GUI</a> from the command line simply type: <br /></p>
                <p class="Free_Form">    &gt; cheetah-gui<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">The Cheetah GUI makes your data processing life simpler. <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">It consists of a table of runs used to coordinate processing and simplify the viewing and monitoring of output.  Looking at your data is the first essential step in analysis so we try to make it as simple as possible.  Similarly, processing multiple runs on the cluster becomes a matter of a few mouse clicks with current processing status updated in the table. <br /></p>
                <p class="Free_Form"><br />Cheetah output is in the form of portable, standardised HDF5 and plain text files.  Viewers called from the GUI open and display these files. Data is grouped by run ID corresponding to one set of measurements.  Careful selection of dataset labels means the table indicates what data goes together and to provide a convenient result database for the whole experiment.  Processing can be automated but we find it useful to have a human think about and review the data before further processing - looking at your data almost always helps and never hurts so we aim to make that step as easy as possible.<br /></p>
                <p class="Free_Form"><br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">The GUI uses a standard Anaconda python 3.x installation with PyQt5 and pyqtgraph and can be used to view and organise data coped home.  To use it at home, copy the whole cheetah directory tree to a local server and run the gui locally.  Modifying the wrapper scripts for your environment will turn it into a single command. The GUI itself spawns backend programs which can also be called directly from the command line if desired.  </p>
              </div>
            </div>
          </div>
          


          <div style="height: 492px; width: 534px;  height: 492px; left: 80px; position: absolute; top: 70px; width: 534px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="GUI_files/droppedImage.png" alt="" style="border: none; height: 492px; width: 535px; " />
          </div>
        </div>
        <div style="margin-left: 0px; position: relative; width: 700px; z-index: 5; " id="body_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
          <div id="id4" style="height: 883px; left: 25px; position: absolute; top: 1089px; width: 651px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_651_883" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style"><span class="style_1">Configuring what Cheetah does is currently performed by editing the cheetah.ini file.   <br /></span></p>
                <p class="paragraph_style"><span class="style_1">Look under </span><a title="Data_processing.html" href="Data_processing.html" class="style_1">Data processing</a><span class="style_1"> for the range of options available.<br /></span></p>
                <p class="paragraph_style"><span class="style_1"><br /></span></p>
                <p class="paragraph_style"><span class="style_1">The most common application is serial crystallography hit finding.  For this there is a sample nanocrystal analysis file in process/lys.ini, and will look for Bragg peaks to find hits.  Open this file and edit it.<br /></span></p>
                <p class="paragraph_style"><span class="style_1"><br /></span></p>
                <p class="paragraph_style"><span class="style_1">In particular, change the line starting with “darkcal=” to point to the dark calibration file you just created.  Or use the ‘current darkcal’ option in combination with the menu item mentioned above. <br /></span></p>
                <p class="paragraph_style"><span class="style_1"><br /></span></p>
                <div class="paragraph paragraph_style"><span class="style_1"></span><div style="height: 370px; width: 516px;  height: 370px; position: relative; width: 516px; " class="tinyText style_SkipStroke_3 inline-block"><img src="GUI_files/droppedImage_1.png" alt="" style="border: none; height: 370px; width: 516px; " /></div><span class="tinyText"> </span><span class="style_1"><br /></span></div>
                <p class="paragraph_style"><span class="style_1"><br /></span></p>
                <p class="Free_Form"><span class="style_1">Select a run with data and </span>click the “Run Cheetah” button and specify ‘lys.ini’ as the configuration file<br /></p>
                <p class="Free_Form">(it is possible to select more than one run at a time).<br /></p>
                <p class="Free_Form"><span class="style_1"><br /></span></p>
                <div class="paragraph Free_Form"><span class="style_1"></span><div style="height: 154px; width: 338px;  height: 154px; position: relative; width: 338px; " class="tinyText style_SkipStroke_2 inline-block"><img src="GUI_files/droppedImage_2.png" alt="" style="border: none; height: 154px; width: 338px; " /></div><span class="tinyText"> </span><span class="style_1"><br /></span></div>
                <p class="Free_Form"><span class="style_1"><br /></span></p>
                <p class="paragraph_style"><span class="style_1">And things should start to happen.  <br /></span></p>
                <p class="paragraph_style"><span class="style_1">Once again jobs should appear in the batch queue<br /></span></p>
                <p class="Free_Form">&gt; bjobs -u all -q psfehq<br /></p>
                <p class="Free_Form">690066  barty   RUN   psfehq     psexport02  6*psana1311 r0001      Oct 23 07:3<br /></p>
                <p class="Free_Form">If the crawler is running, the Cheetah status and number of processed frames should update periodically<br /></p>
                <p class="Free_Form">Data should start to appear in the cheetah/hdf5 directory<br /></p>
                <p class="paragraph_style"><br /></p>
                <p class="Free_Form">If not, something is wrong and it’s time for debugging.  In particular look at the output of hdf5/run0xxx/bsub.log.<span class="style_1"><br /></span></p>
                <p class="paragraph_style"><span class="style_1"><br /></span></p>
                <p class="paragraph_style"><span class="style_1">The setup is now done and it’s time for optimisation of the output.<br /></span></p>
              </div>
              <div style="clear: both; height: 0px; line-height: 0px; " class="tinyText"> </div>
            </div>
          </div>
          


          <div id="id5" style="height: 20px; left: 21px; position: absolute; top: 46px; width: 515px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content style_External_515_20" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_1">1. enabling command operations and starting the crawler</p>
              </div>
            </div>
          </div>
          


          <div id="id6" style="height: 106px; left: 17px; position: absolute; top: 65px; width: 660px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_660_106" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">By default the GUI starts in a ‘do not destroy my data by accident’ mode whereby it is not possible to launch commands that may modify or delete data.  This is deliberate. Activate command operations through the file menu. <br /></p>
                <p class="Free_Form"><br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">Processing of data and updating of the GUI table as an experiment progresses requires the crawler to be started. This little process runs in the background gathering information on the status of XTC files available on disk and the progress of Cheetah jobs.   It can overwrite the current table contents, and only one person should run this at any one time (even though many people can view the GUI at once). </p>
              </div>
            </div>
          </div>
          


          <div id="id7" style="height: 190px; left: 17px; position: absolute; top: 199px; width: 303px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_303_190" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">To start the crawler it is first necessary to go <br /></p>
                <p class="Free_Form">    File-&gt;Unlock command operations<br /></p>
                <p class="Free_Form">then <br /></p>
                <p class="Free_Form">    File-&gt;Start Crawler<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Unlocking command operations enables the Crawler option and the “Run Cheetah” button.  This step is deliberately added in order to force one to think before overwriting existing data. <br /></p>
                <p class="Free_Form"><br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">A little window with the crawler should appear on screen.  It should periodically do something and update the table. Look in the terminal for any errors. </p>
              </div>
            </div>
          </div>
          


          <div id="id8" style="height: 20px; left: 21px; position: absolute; top: 472px; width: 515px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content style_External_515_20" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_1">2. Running jobs - a dark calibration file</p>
              </div>
            </div>
          </div>
          


          <div id="id9" style="height: 92px; left: 17px; position: absolute; top: 495px; width: 660px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_660_92" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">This is also a good way to check that everythying is working.<br /></p>
                <p class="Free_Form">The detector needs to be corrected for static offsets, often known as ‘dark frames’.  Make sure to take one at the start of the experiment and every few hours during the experiment. <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Click the “Run Cheetah” button and specify ‘darkcal.ini’ as the configuration file. <br /></p>
              </div>
            </div>
          </div>
          


          <div id="id10" style="height: 260px; left: 17px; position: absolute; top: 766px; width: 660px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_660_260" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form">The job should now be go to the batch queue for processing.<br /></p>
                <p class="Free_Form">Jobs should appear in the batch queue<br /></p>
                <p class="Free_Form">&gt; bjobs -u all -q psfehq<br /></p>
                <p class="Free_Form">690066  barty   RUN   psfehq     psexport02  6*psana1311 r0001      Oct 23 07:3<br /></p>
                <p class="Free_Form">If the crawler is running, the Cheetah status and number of processed frames should update periodically<br /></p>
                <p class="Free_Form">Data should start to appear in the cheetah/hdf5 directory<br /></p>
                <p class="Free_Form">In particular, a file called r00xx-CxiDs1-darkcal.h5 should start to appear.<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">If not, something is wrong and it’s time for debugging<br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">If all goes well, wait for the job to finish then copy the file r00xx-CxiDs1-darkcal.h5 into the cheetah/calib/darkcal directory. <br /></p>
                <p class="Free_Form"><br /></p>
                <p class="Free_Form">Once the darkcal is finished running, create a bad pixel map from the darkcal using the Cheetah tools Cheetah-&gt;badpix from darkcal and save it in the cheetah/calib/masks directory. <br /></p>
                <p class="Free_Form"><br /></p>
                <p style="padding-bottom: 0pt; " class="Free_Form">A simple menu command exists to copy this over to the calib/darkcal directory once completed, and set it as the ‘current darkcal’.</p>
              </div>
            </div>
          </div>
          


          <div id="id11" style="height: 20px; left: 21px; position: absolute; top: 1056px; width: 515px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content style_External_515_20" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_1">3. Other analysis - parameters in the cheetah.ini file</p>
              </div>
            </div>
          </div>
          


          <div id="id12" style="height: 20px; left: 21px; position: absolute; top: 2208px; width: 515px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content style_External_515_20" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_1">5. sit back and enjoy your experiment (and a cup of tea)</p>
              </div>
            </div>
          </div>
          


          <div id="id13" style="height: 235px; left: 17px; position: absolute; top: 2226px; width: 660px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_660_235" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="paragraph_style"><span class="style_1">Setup of the guI should now be done and it’s time to analyse some data.<br /></span></p>
                <p class="Free_Form"><span class="style_1"><br /></span></p>
                <p class="Free_Form"><span class="style_1">A few hints:<br /></span></p>
                <p class="Free_Form"><span class="style_1"><br /></span></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="1">
                    <p style="text-indent: -13px; " class="paragraph_style_2"><span style="font-size: 12px; " class="Bullet">1)</span><span style="width: 3px; " class="inline-block"></span>Review your output.  Often.  Default parameters may work, or they may not.  No analysis should ever be done completely blind.  Use the ‘Show hits” button to look at images and refine the hit finding parameters. <br /></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="2">
                    <p style="text-indent: -13px; " class="paragraph_style_2"><span style="font-size: 12px; " class="Bullet">2)</span><span style="width: 3px; " class="inline-block"></span><span class="style_1">It is convenient to start a new .ini file for each type of sample.  The name of the .ini file is used by the GUI to tag runs and update the table, and ends up as the tag name on the HDF5 directories created.  Separate names helps keep separate samples apart, and makes it easy to copy/tar/grep directories based on sample name or other experiment parameters.  This helps keep data organised and will be of great benefit later on. <br /></span></p>
                  </li>
                </ol>
                <p class="Free_Form"><br /></p>
                <ol>
                  <li style="line-height: 14px; padding-left: 13px; text-indent: -13px; " class="full-width" value="3">
                    <p style="padding-bottom: 0pt; text-indent: -13px; " class="paragraph_style_2"><span style="font-size: 12px; " class="Bullet">3)</span><span style="width: 3px; " class="inline-block"></span>Nothing happening?  Seems like your processing job never starts, and nothing is waiting in the batch queue?  <br />Check the View-&gt;bsub.log file.  This displays the log file from the batch submission process and likely will show some kind of error message.  Common mistakes are an error in typing in the darkcal or mask file names.</p>
                  </li>
                </ol>
              </div>
            </div>
          </div>
          


          <div id="id14" style="height: 20px; left: 21px; position: absolute; top: 1993px; width: 515px; z-index: 1; " class="style_SkipStroke_4 shape-with-text">
            <div class="text-content style_External_515_20" style="padding: 0px; ">
              <div class="style">
                <p style="padding-bottom: 0pt; padding-top: 0pt; " class="paragraph_style_1">4. Permissions housekeeping</p>
              </div>
            </div>
          </div>
          


          <div id="id15" style="height: 134px; left: 17px; position: absolute; top: 2017px; width: 660px; z-index: 1; " class="style_SkipStroke_1 shape-with-text">
            <div class="text-content graphic_textbox_layout_style_default_External_660_134" style="padding: 0px; ">
              <div class="graphic_textbox_layout_style_default">
                <p style="padding-top: 0pt; " class="Free_Form"><span class="style_1">Working on your own is easy.  Working as a part of a group during an experiment involves setting up directory access permissions so that everyone can see and access the files.<br /></span></p>
                <p class="Free_Form"><span class="style_1"><br /></span></p>
                <p class="Free_Form"><span class="style_1">Here’s a quick set of commands to give everyone in your experiment access to the data:<br /></span></p>
                <p class="Free_Form"><span class="style_1">    &gt; chgrp -R {cxi12345} cheetah<br /></span></p>
                <p class="Free_Form"><span class="style_1">    &gt; chmod -R g+w cheetah<br /></span></p>
                <p class="Free_Form"><span class="style_1">    &gt; chmod -R g+s cheetah<br /></span></p>
                <p style="padding-bottom: 0pt; " class="Free_Form"><span class="style_1">where </span>{cxi12345} should of course be replaced by your experiment name.  We try to do this as a part of automated setup, but sometimes it doesn’t work as expected. </p>
              </div>
            </div>
          </div>
          


          <div style="height: 116px; width: 237px;  height: 116px; left: 330px; position: absolute; top: 175px; width: 237px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="GUI_files/droppedImage.jpg" alt="" style="border: none; height: 117px; width: 237px; " />
          </div>
          


          <div style="height: 103px; width: 326px;  height: 103px; left: 324px; position: absolute; top: 323px; width: 326px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="GUI_files/droppedImage_3.png" alt="" style="border: none; height: 103px; width: 326px; " />
          </div>
          


          <div style="height: 154px; width: 338px;  height: 154px; left: 178px; position: absolute; top: 596px; width: 338px; z-index: 1; " class="tinyText style_SkipStroke_2">
            <img src="GUI_files/droppedImage_4.png" alt="" style="border: none; height: 154px; width: 338px; " />
          </div>
          <div style="height: 2461px; line-height: 2461px; " class="spacer"> </div>
        </div>
        <div style="height: 75px; margin-left: 0px; position: relative; width: 700px; z-index: 15; " id="footer_layer">
          <div style="height: 0px; line-height: 0px; " class="bumper"> </div>
        </div>
      </div>
    </div>
  </body>
</html>


